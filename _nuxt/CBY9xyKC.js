import{l as H,i as V,e as D,_ as L,f as O,g as W,h as X,b as Y}from"./CkARFHBF.js";import{e as w,q as B,o as d,k as Z,w as ee,z as te,b as v,A as se,c as p,a as l,t as M,l as oe,f as ae,g as c,F as U,r as k,V as E,h as re}from"./C88qKsPz.js";import ne from"./CxH68gFP.js";import{c as I,a as S,b as F}from"./oP2VfrXJ.js";const Be=w({__name:"SearchInput",setup(o){const a=B("");return(s,t)=>{const e=H,n=V;return d(),Z(n,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=u=>a.value=u),name:"q",placeholder:"Buscar",icon:"i-heroicons-magnifying-glass-20-solid",autocomplete:"off",ui:{icon:{trailing:{pointer:""}}}},{trailing:ee(()=>[te(v(e,{color:"gray",variant:"link",icon:"i-heroicons-x-mark-20-solid",padded:!1,onClick:t[0]||(t[0]=u=>a.value="")},null,512),[[se,a.value!==""]])]),_:1},8,["modelValue"])}}}),le={class:"rounded-lg w-4/5 border-primary-color border-2 text-center mt-2 p-1 hover:border-tarawera-700 hover:text-tarawera-700 hover:scale-105 transition-all duration-300"},ie={class:"pt-2 text-sm"},Ee=w({__name:"AddCourseButton",props:{text:{type:String,required:!0}},emits:["handleAdd"],setup(o,{emit:a}){const s=a;return(t,e)=>{const n=ne;return d(),p("div",le,[l("button",{class:"flex flex-col items-center justify-center cursor-pointer w-fit m-auto text-primary-color hover:text-tarawera-700",onClick:e[0]||(e[0]=u=>s("handleAdd")),"aria-label":"Agregar nuevo curso"},[v(n,{name:"icon-park-solid:add",size:"24",class:"text-primary-color hover:text-tarawera-700"}),l("p",ie,M(o.text),1)])])}}}),ue="data:image/webp;base64,UklGRnYAAABXRUJQVlA4TGkAAAAvJ8AJAE+gpm0jqOVPteO9U2gQBJDkDzfCI4wQkbbN/Ps8HT3c/Af2f1WJAGoCSBgkA0aRZLUiCUDDEM5PGxJwgd/MD+eI/k9A+8+57HDyszKA9gBl5NSknEkA2gPUUddJ2/h/Ut3xWwEA",ce={class:"flex items-start gap-4 my-4"},de=w({__name:"BulletPoint",emits:["addBulletPoint"],setup(o,{emit:a}){const s=a,t=()=>{s("addBulletPoint")};return(e,n)=>(d(),p("div",ce,[n[1]||(n[1]=l("div",{class:"min-w-[120px]"},null,-1)),l("button",{onClick:t,class:"flex justify-center items-center gap-2 bg-light-grayish-blue py-2 cursor-pointer w-full transform hover:scale-80 hover:shadow-lg active:scale-100 active:shadow-sm transition-all duration-300"},n[0]||(n[0]=[l("img",{src:ue,alt:"add a bullet point",class:"w-5"},null,-1),l("p",{class:"text-primary-color"},"Add a bullet Point",-1)]))]))}}),b={title:"Create Course",showExtraElements:!0,categorys:["General English","Business English","ESP"],levels:["A0. True Beginner","A1. Elementary","A2. Pre-Intermediate","B1. Intermediate","B2. Upper Intermediate"],label_select:["category:","level:"],buttonText:"Create Course"},Ve={title:"Create a new Class",showExtraElements:!1,buttonText:"Create Class"},me=[{id:1,label_name:"Course Name: ",type:"text"},{id:2,label_name:"Description:",type:"text_area"}];function pe(){const o=B([]),a=B({course_name:"",description:"",category:"",level:"",cover:null,bullet_points:[]}),s=()=>{o.value=[],a.value={course_name:"",description:"",category:"",level:"",cover:null,bullet_points:[]}},t=()=>{o.value.push("")},e=()=>({...a.value,bullet_points:JSON.stringify(o.value.filter(u=>u.trim()!==""))}),n=(u,h)=>{a.value[u]=h};return{bulletPoints:o,formData:oe(()=>a.value),handleEmit:t,handleEmitSave:e,updateFormField:n,resetForm:s}}function _e(o){return o.toLowerCase().trim().replace(/[:]/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"")}const ve=()=>{const o=I();return D({mutationFn:async s=>{console.log("Course data:",s);const t=await S.post(F.courses,s,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json"}});return console.log("Course created:",t.data),t.data},onMutate:async s=>{await o.cancelQueries({queryKey:["courses"]});const t=o.getQueryData(["courses"]);return o.setQueryData(["courses"],(e=[])=>{const n={...s,id:"temp-"+Date.now(),imageUrl:URL.createObjectURL(s.cover),lessonCount:0};return[...e,n]}),{previousCourses:t}},onError:(s,t,e)=>{o.setQueryData(["courses"],e==null?void 0:e.previousCourses)},onSettled:()=>{o.invalidateQueries({queryKey:["courses"]})}})},ye=()=>{const o=I();return D({mutationFn:async s=>(await S.post(F.classes.getByCourseId(s.course_id),s,{headers:{"Content-Type":"multipart/form-data"}})).data,onMutate:async s=>{const t=s.course_id;await o.cancelQueries({queryKey:["classes",t]});const e=o.getQueryData(["classes",t]);return o.setQueryData(["classes",t],(n=[])=>{const u={...s,id:"temp-"+Date.now(),imageUrl:URL.createObjectURL(s.cover)};return[...n,u]}),{previousClasses:e,courseId:t}},onError:(s,t,e)=>{e!=null&&e.courseId&&o.setQueryData(["classes",e.courseId],e.previousClasses)},onSettled:(s,t)=>{t!=null&&t.course_id&&o.invalidateQueries({queryKey:["classes",t.course_id]})}})},fe={class:"p-5 max-w-7xl m-auto w-full bg-white rounded-lg h-[90vh] overflow-y-auto"},ge={class:"flex justify-between"},be={class:"font-bold text-m"},Ce={key:0},we={class:"flex gap-4"},he={class:"flex justify-center gap-4 mt-6"},De=w({__name:"AddCourseModal",props:{title:{},showExtraElements:{type:Boolean},options:{}},emits:["closeModal"],setup(o,{emit:a}){const s=ae(),{bulletPoints:t,formData:e,handleEmit:n,updateFormField:u,resetForm:h}=pe(),P=ve(),$=ye(),Q=[{options:b.categorys,title:b.label_select[0]},{options:b.levels,title:b.label_select[1]}],q=a,A=()=>{q("closeModal")},C=i=>_e(i),J=(i,r)=>{const _=C(i);e.value[_]=r},N=b.categorys[0],R=b.levels[0],j=async()=>{var r,_;if(!((_=(r=e.value)==null?void 0:r.course_name)!=null&&_.trim())){alert("El nombre es obligatorio");return}const i=s.name==="course-courseId"?"class":"course";try{if(i==="class"){const y={class_name:e.value.course_name,description:e.value.description,course_id:s.params.courseId,bullet_points:JSON.stringify(Array.from(t.value)),cover:e.value.cover};await $.mutateAsync(y)}else{const y={course_name:e.value.course_name,description:e.value.description,category:e.value.category||N,level:e.value.level||R,bullet_points:JSON.stringify(Array.from(t.value)),cover:e.value.cover};await P.mutateAsync(y)}h(),A()}catch(y){console.error("Error creating course/class:",y)}},K=i=>{const r=i.name.replace(/\s+/g,"_"),_=new File([i],r,{type:i.type});e.value.cover=_};return(i,r)=>{const _=O,y=Y,T=V,z=W;return d(),p("div",fe,[l("div",ge,[l("h2",be,M(i.title),1),l("img",{src:L,alt:"close create course",class:"w-5 h-5 cursor-pointer",onClick:A})]),l("form",{onSubmit:r[1]||(r[1]=E(()=>{},["prevent"])),onClick:r[2]||(r[2]=E(()=>{},["stop"]))},[l("div",null,[v(_,{modelValue:c(e).cover,"onUpdate:modelValue":r[0]||(r[0]=f=>c(e).cover=f),onFileSelected:K},null,8,["modelValue"]),(d(!0),p(U,null,k(c(me),(f,g)=>(d(),p("div",{key:"label-"+g},[v(y,{title:f.label_name,type:f.type,modelValue:c(e)[C(f.label_name)],"onUpdate:modelValue":m=>c(u)(C(f.label_name),m),size:"lg"},null,8,["title","type","modelValue","onUpdate:modelValue"]),i.showExtraElements&&g===1?(d(),p("div",Ce,[l("div",we,[(d(),p(U,null,k(Q,(m,G)=>l("div",{key:G,class:"flex-1"},[v(X,{options:m.options,title:m.title,modelValue:c(e)[C(m.title)],"onUpdate:modelValue":[x=>c(e)[C(m.title)]=x,x=>J(m.title,x)]},null,8,["options","title","modelValue","onUpdate:modelValue"])])),64))])])):re("",!0)]))),128)),(d(!0),p(U,null,k(c(t),(f,g)=>(d(),p("div",{key:g,class:"flex items-center gap-4 mb-4"},[r[3]||(r[3]=l("div",{class:"min-w-[120px]"},null,-1)),v(T,{type:"text",size:"xl",class:"w-full",modelValue:c(t)[g],"onUpdate:modelValue":m=>c(t)[g]=m},null,8,["modelValue","onUpdate:modelValue"])]))),128)),v(de,{onAddBulletPoint:c(n)},null,8,["onAddBulletPoint"])]),l("div",he,[r[4]||(r[4]=l("div",{class:"min-w-[120px]"},null,-1)),v(z,{onHandleSave:j,onHandleCancel:A,isActive:!0})])],32)])}}});export{De as _,Be as a,Ee as b,Ve as c,b as d};
